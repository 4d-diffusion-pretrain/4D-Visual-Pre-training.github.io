<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Deformable Neural Radiance Fields creates free-viewpoint portraits (nerfies) from casually captured videos.">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DP4: Robot Learning with 4D Diffusion Pre-training</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!--<link rel="icon" href="./static/images/favicon.svg">-->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://jackhck.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://3d-diffusion-policy.github.io">
           DP3
          </a>
          <a class="navbar-item" href="https://rise-policy.github.io">
            RISE
          </a>
          <a class="navbar-item" href="https://diffusion-policy.cs.columbia.edu">
            Diffusion Policy
          </a>
          <a class="navbar-item" href="https://tetexiao.com/projects/real-mvp">
            MVP
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">DP4: Robot Learning with 4D Diffusion Pre-training</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://jackhck.github.io">Chengkai Hou</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://yanjieze.com">Yanjie  Ze</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="">Yue Yu</a><sup>3</sup>,
            <span class="author-block">
              <a href="">Songbo  Hu</a><sup>3</sup>,
            <span class="author-block">
              <a href="https://www.danbgoldman.com">Huazhe Xu</a><sup>1,3,4</sup>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Shanghai Qi Zhi Institute</span>
            <span class="author-block"><sup>2</sup>Stanford University </span>
            <span class="author-block"><sup>3</sup>Tsinghua University, IIIS </span>
            <span class="author-block"><sup>4</sup>Shanghai AI Lab  </span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
     <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Real-world Tasks</h2>
    <div class="columns is-centered">
      <!-- Visual Effects. -->
      <div class="column">
        <div class="content">
          <h2 class="title is-3">Pick</h2>
          <p>
            The robot grasps the red static block and places it into the bowl. (Video 2x speed)
          </p>
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/Pick.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
      <!--/ Visual Effects. -->

      <!-- Matting. -->
      <div class="column">
        <h2 class="title is-3">Draw</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              The robot picks up a wooden pen and draws a specified pattern.(Video 2x speed)

            </p>
            <video id="matting-video" controls playsinline height="100%">
              <source src="./static/videos/Draw.mp4"
                      type="video/mp4">
            </video>
          </div>

        </div>
      </div>
    </div>
    
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
    <div class="columns is-centered">

      <!-- Visual Effects. -->
      <div class="column">
        <div class="content">
          <h2 class="title is-3">Trace</h2>
          <p>
          The robot grabs a randomly moving toy chicken into a bowl.(Video 2x speed)
          </p>
          <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
            <source src="./static/videos/Trace.mp4"
                    type="video/mp4">
          </video>
        </div>
      </div>
      <!--/ Visual Effects. -->

      <!-- Matting. -->
      <div class="column">
        <h2 class="title is-3">Push</h2>
        <div class="columns is-centered">
          <div class="column content">
            <p>
              The robot pushes the soccer ball into the goal.(Video 2x speed)
            </p>
            <video id="matting-video" controls playsinline height="100%">
              <source src="./static/videos/Push.mp4"
                      type="video/mp4">
            </video>
          </div>

        </div>
      </div>
    </div>
    
  </div>
</section>

              
<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            General visual representations learned from web-scale datasets for robotics such as R3M and MVP have achieved great success in recent years, enabling data-efficient robot learning on manipulation tasks;

          </p>
          <p>
          yet these pre-trained representations are mostly on 2D images, neglecting the inherent 3D nature of the world. However, due to the scarcity of large-scale 3D data, it is still hard to extract a universal 3D representation from web datasets. Instead, we seek for a general visual pre-training framework that could improve all 3D representations as an alternative. Our framework, called <b> DP4 </b>, is a novel 4D Diffusion Pre-training framework for real-world robot learning. DP4 frames the visual pre-training objective as a next-point-cloud-prediction problem, models the prediction model as a diffusion model, and pre-trains the model on in-domain task datasets directly. 
          </p>
          <p>
           Across four real-world manipulation tasks, DP4 boosts the average success rate of 3D Diffusion Policy (DP3) for these tasks by <b> 25% </b>, and DP3 pre-trained by DP4 achieves state-of-the-art performance across imitation learning methods. Moreover, the efficacy of DP4 extends across various point cloud encoders and datasets, showing its potential in training on large datasets.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Model Overview</h2>
        <div class="content has-text-justified">
          <p>
           DP4 mainly consists of two parts: a 3D visual encoder and a point cloud diffusion model. The 3D visual encoder transforms the point cloud
at time step t into the latent visual representation, and the diffusion model uses the latent visual
representation and robotic actions to predict the point cloud at step time t + 1. During the policy
learning stage, we train the pre-trained visual model and the policy backbone jointly.

           </p>
            <p> 
              </p>
              <p> 
              </p>
              <img src="./static/images/method.png" alt="Pipline of DP4" />
              <p> 
              </p>
              <p>
              </p>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>

  </div>
</section>


<section class="section">

    <div class="columns is-centered has-text-centered">

    <div class="column is-four-fifths">
        <!-- Re-rendering. -->
        <h3 class="title is-3">Real Task 1: Pick</h2>
        <div class="content has-text-centered">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/meger_pick.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!--/ Re-rendering. -->
  </div>
</section>

<section class="section">

    <div class="columns is-centered has-text-centered">

    <div class="column is-four-fifths">
        <!-- Re-rendering. -->
        <h3 class="title is-3">Real Task 2: Draw</h2>
        <div class="content has-text-centered">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/meger_draw.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!--/ Re-rendering. -->
  </div>
</section>

<section class="section">

    <div class="columns is-centered has-text-centered">

    <div class="column is-four-fifths">
        <!-- Re-rendering. -->
        <h3 class="title is-3">Real Task 3: Trace</h2>
        <div class="content has-text-centered">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/meger_trace.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!--/ Re-rendering. -->
  </div>
</section>

<section class="section">

    <div class="columns is-centered has-text-centered">

    <div class="column is-four-fifths">
        <!-- Re-rendering. -->
        <h3 class="title is-3">Real Task 4: Push</h2>
        <div class="content has-text-centered">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/meger_push.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!--/ Re-rendering. -->
  </div>
</section>


<section class="section">

    <div class="columns is-centered has-text-centered">

    <div class="column is-four-fifths">
        <!-- Re-rendering. -->
        <h3 class="title is-3">Diffusion Results</h2>
        <div class="content has-text-centered">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="./static/videos/replay.mp4"
                    type="video/mp4">
          </video>
        </div>
        <!--/ Re-rendering. -->
  </div>
</section>





       
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{cheng2024dp4,
  author    = {Chengkai Hou, Yanjie Ze, Yue Yu, Songbo Hu, and Huazhe Xu},
  title     = {DP4: Robot Learning with 4D Diffusion Pre-training},
  journal   = {arXiv},
  year      = {2024},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
